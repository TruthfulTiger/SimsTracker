<check if="{{ @sims }}">
	<true>
		<table width="100%" cellpadding="5" id="sims" class="table table-hover table-bordered">
			<thead>
			<tr>
				<th scope="col">
						<select class="custom-select" id="hhSort">
						<option value="">Household</option>
						<repeat group="{{ @households }}" value="{{ @household }}">
						<option value="{{ trim(@household.name) }}">{{ trim(@household.name) }}</option>
						</repeat>
						</select>
				</th>
				<th scope="col">Name</th>
					<th scope="col">
						<select class="custom-select" id="ageSort">
						<option value="">Age</option>
						<repeat group="{{ @ages }}" value="{{ @age }}">
						<option value="{{ @age }}">{{ @age }}</option>
						</repeat>
						</select>
				</th>
					<th scope="col">
						<select class="custom-select" id="lifeSort">
						<option value="">Life State</option>
						<option value="Alive">Alive</option>
						<option value="Deceased">Deceased</option>
						</select>
				</th>
					<th scope="col">
						<select class="custom-select" id="genderSort">
						<option value="">Gender</option>
						<option value="Female">Female</option>
						<option value="Male">Male</option>
						</select>
				</th>
				<th scope="col">Action</th>
			</tr>
			</thead>

			<tbody>
			<repeat group="{{ @households }}" value="{{ @household }}">
				<repeat group="{{ @sims }}" value="{{ @sim }}">
					<check if="{{ @sim.hhID == @household.hhID }}">
						<tr>
							<td>{{ trim(@household.name) }}</td>
							<td>{{ trim(@sim.firstName) }}</td>
							<td>{{ trim(@sim.age) }}</td>
							<td>{{ trim(@sim.lifeState) }}</td>
							<td>
							<check if="{{ @sim.gender == 'M' }}">
								<true>
								Male
								</true>
								<false>
								Female
								</false>
							</check>
							</td>
							<td><a href="{{ @BASE.'/sim/view/'. @sim.id }}" data-toggle="tooltip" title="View" class="text-info" target="_blank"><i class="fa fa-eye"></i></a>&nbsp;&nbsp;
								<a href="{{ @BASE.'/sim/update/'. @sim.id }}" data-toggle="tooltip" title="Edit" class="text-primary"><i class="fa fa-edit"></i></a>&nbsp;&nbsp;
								<a href="#" onclick="confirm('{{ @BASE.'/sim/delete/'. @sim.id }}');"
								   data-toggle="tooltip"
								   title="Delete"
								   class="text-danger delete"><i class="fa fa-trash"></i></a>
								</td>
						</tr>
					</check>
				</repeat>
			</repeat>
			</tbody>
		</table>
	</true>
	<false>
		<p>No sims found.</p>
	</false>
</check>
<a href="{{ @BASE.'/sim/create' }}" class="btn btn-success"><i class="fa fa-plus" aria-hidden="true"></i> Create</a>
<a href="#simMove" id="move" name="move" class="btn btn-primary" data-toggle="modal" data-target="#simMove"><i class="fas fa-exchange-alt" aria-hidden="true"></i> Move</a>

<div class="modal fade" id="simMove" tabindex="-1" aria-labelledby="simMoveLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="simMoveLabel">Move sim</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
	  <form action="{{ @BASE.'/sim/move' }}" validate="true" method="post" class="form-horizontal">
		<div class="form-group">
			<label for="hhSims">Choose sims to move (hold Ctrl to choose more than 1)</label>
				<select class="custom-select" multiple name="hhSims[]" id="hhSims">
					<repeat group="{{ @sims }}" value="{{ @sim }}">
						<option value="{{ @sim.id }}">{{ @sim.firstName }} {{ @sim.lastName }}</option>
					</repeat>
				</select>
		</div>
		<div class="form-group">
			<label for="hhID">Where are you moving these sims?</label>
				<select class="custom-select" name="hhID" id="hhID">
					<repeat group="{{ @households }}" value="{{ @hh }}">
						<option value="{{ @hh.hhID }}">{{ @hh.name }}</option>
					</repeat>
				</select>
		</div>		
      </div>
      <div class="modal-footer">
		<!-- Hidden fields and form submission -->
		<div class="control-group">
			<div class="">
			<input type="text" class="hptrap" name="hptrap" />
				<button type="submit" class="btn btn-primary"><i class="fa fa-save" aria-hidden="true"></i> Save</button></a>
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
				</form>
			</div>
		</div>
      </div>
    </div>
  </div>
</div>

<script>
$(document).ready( function () {
    let table = $('#sims').DataTable({
		ordering: false,
        responsive: {
        breakpoints: [
            { name: 'desktop', width: Infinity },
            { name: 'tablet',  width: 1024 },
            { name: 'fablet',  width: 768 },
            { name: 'phone',   width: 480 }
        ]
    }
	});
	$('#hhSort').change(function() {
		let val = $(this).find('option:selected').val();
		console.log(val);
		table.columns(0).search(val).draw();
	});
	$('#ageSort').change(function() {
		let val = $(this).find('option:selected').val();
		table.columns(2).search(val).draw();
	});
	$('#lifeSort').change(function() {
		let val = $(this).find('option:selected').val();
		table.columns(3).search(val).draw();
	});
	$('#genderSort').change(function() {
		let val = $(this).find('option:selected').val();
		table.columns(4).search(val).draw();
	});
} );
</script>
